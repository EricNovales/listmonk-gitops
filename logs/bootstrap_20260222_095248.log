========== 0) Estado del Cluster y Componentes  ==========
[0;34m[APPLYING][0m Verificando DNS local (/etc/hosts)
[0;33m[WARNING][0m DNS local ya configurado (skip)
[0;32m[OK][0m Traefik no detectado
[0;33m[WARNING][0m ingress-nginx ya est√° instalado (skip)
[0;33m[WARNING][0m sealed-secrets ya est√° instalado (skip)
[0;32m[OK][0m Cluster listo

========== 1) Localstack ==========
[0;33m[WARNING][0m Namespace 'localstack' ya existe (skip)
[0;33m[WARNING][0m Helm release 'localstack' ya existe en ns 'localstack' (skip)
[0;33m[WARNING][0m Bucket 'terraform-state' ya existe (skip)

========== 2) Terraform ==========
[0;34m[APPLYING][0m Inicializando Terraform
Initializing the backend...
Initializing provider plugins...
- Reusing previous version of hashicorp/helm from the dependency lock file
- Reusing previous version of hashicorp/kubernetes from the dependency lock file
- Using previously-installed hashicorp/helm v3.1.1
- Using previously-installed hashicorp/kubernetes v3.0.1

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.
[0;34m[APPLYING][0m Aplicando infraestructura
kubernetes_namespace_v1.argocd: Refreshing state... [id=argocd]
kubernetes_namespace_v1.monitoring: Refreshing state... [id=monitoring]
kubernetes_namespace_v1.argo-rollouts: Refreshing state... [id=argo-rollouts]
kubernetes_namespace_v1.listmonk: Refreshing state... [id=listmonk]
kubernetes_namespace_v1.mail: Refreshing state... [id=mail]
kubernetes_service_account_v1.mailpit: Refreshing state... [id=mail/mailpit]
kubernetes_service_account_v1.postgres: Refreshing state... [id=listmonk/postgres]
kubernetes_network_policy_v1.listmonk_default_deny: Refreshing state... [id=listmonk/default-deny]
helm_release.kps: Refreshing state... [id=kps]
helm_release.pg_exporter: Refreshing state... [id=pg-exporter]
kubernetes_service_account_v1.listmonk: Refreshing state... [id=listmonk/listmonk]
helm_release.loki: Refreshing state... [id=loki]
helm_release.promtail: Refreshing state... [id=promtail]
kubernetes_network_policy_v1.listmonk_allow_pg_exporter_to_postgres: Refreshing state... [id=listmonk/allow-pg-exporter-to-postgres]
kubernetes_network_policy_v1.listmonk_allow_dns_egress: Refreshing state... [id=listmonk/allow-dns-egress]
kubernetes_network_policy_v1.listmonk_allow_ingress_nginx_to_listmonk: Refreshing state... [id=listmonk/allow-ingress-nginx-to-listmonk]
kubernetes_network_policy_v1.listmonk_allow_monitoring_to_pg_exporter: Refreshing state... [id=listmonk/allow-monitoring-to-pg-exporter]
kubernetes_network_policy_v1.listmonk_allow_egress_from_listmonk: Refreshing state... [id=listmonk/allow-egress-from-listmonk]
kubernetes_network_policy_v1.listmonk_allow_egress_analysis_to_listmonk: Refreshing state... [id=listmonk/allow-egress-analysis-to-listmonk-and-dns]
kubernetes_network_policy_v1.listmonk_allow_pg_exporter_into_postgres: Refreshing state... [id=listmonk/allow-pg-exporter-into-postgres]
kubernetes_network_policy_v1.listmonk_allow_ingress_to_listmonk_from_analysis: Refreshing state... [id=listmonk/allow-ingress-to-listmonk-from-analysis]
kubernetes_network_policy_v1.listmonk_allow_listmonk_to_postgres: Refreshing state... [id=listmonk/allow-listmonk-to-postgres]
kubernetes_network_policy_v1.mail_default_deny: Refreshing state... [id=mail/default-deny]
kubernetes_network_policy_v1.allow_postgres_ingress_from_backup: Refreshing state... [id=listmonk/allow-postgres-ingress-from-backup]
kubernetes_network_policy_v1.allow_backup_egress_postgres_localstack: Refreshing state... [id=listmonk/allow-backup-egress-postgres-dns-localstack]
kubernetes_network_policy_v1.mail_allow_ui_from_ingress_nginx: Refreshing state... [id=mail/allow-ui-from-ingress-nginx]
kubernetes_network_policy_v1.mail_allow_smtp_from_listmonk: Refreshing state... [id=mail/allow-smtp-from-listmonk]
kubernetes_manifest.monitoring_sealedsecret: Refreshing state...
kubernetes_manifest.aws-user_sealedsecret: Refreshing state...
kubernetes_manifest.listmonk_postgres_sealedsecret: Refreshing state...

No changes. Your infrastructure matches the configuration.

Terraform has compared your real infrastructure against your configuration
and found no differences, so no changes are needed.

Apply complete! Resources: 0 added, 0 changed, 0 destroyed.
[0;32m[OK][0m Terraform aplicado correctamente
========== 3) ArgoCD + Rollouts ==========
[0;33m[WARNING][0m Namespace 'argocd' ya existe (skip)
[0;33m[WARNING][0m Namespace 'argo-rollouts' ya existe (skip)
[0;33m[WARNING][0m Helm release 'argocd' ya existe en ns 'argocd' (skip)
[0;33m[WARNING][0m Helm release 'argo-rollouts' ya existe en ns 'argo-rollouts' (skip)
[0;33m[WARNING][0m appproject.argoproj.io/listmonk ya existe en ns 'argocd' (skip apply)
[0;33m[WARNING][0m application.argoproj.io/listmonk ya existe en ns 'argocd' (skip apply)
[0;34m[APPLYING][0m Esperando a que exista rollout/listmonk en 'listmonk'...
[0;34m[APPLYING][0m Esperando rollout status de rollout/listmonk en 'listmonk'...
[0;32m[OK][0m rollout/listmonk listo en 'listmonk'

========== 4) Mail + Webhook ==========
[0;33m[WARNING][0m Mailpit ya existe (skip apply -k infra/mail)
[0;33m[WARNING][0m webhook-receiver ya existe (skip apply)

========== 5) Creaci√≥n S3 Bucket para el Backup ==========
[0;33m[WARNING][0m Bucket 'listmonk-postgres-backup' ya existe (skip)

============================================================
[0;32mBOOTSTRAP COMPLETADO[0m
============================================================

[0;34mNamespaces:[0m
NAME              STATUS   AGE
argo-rollouts     Active   42m
argocd            Active   42m
cert-manager      Active   97d
default           Active   97d
ingress-nginx     Active   97d
kube-node-lease   Active   97d
kube-public       Active   97d
kube-system       Active   97d
listmonk          Active   42m
localstack        Active   42m
mail              Active   42m
monitoring        Active   42m

[0;34mHelm releases:[0m
NAME         	NAMESPACE    	REVISION	UPDATED                                	STATUS  	CHART                             	APP VERSION
argo-rollouts	argo-rollouts	1       	2026-02-22 09:18:13.482396181 +0000 UTC	deployed	argo-rollouts-2.40.5              	v1.8.3     
argocd       	argocd       	1       	2026-02-22 09:12:33.374239301 +0000 UTC	deployed	argo-cd-9.4.2                     	v3.3.0     
kps          	monitoring   	1       	2026-02-22 09:11:26.891234644 +0000 UTC	deployed	kube-prometheus-stack-56.6.0      	v0.71.2    
localstack   	localstack   	1       	2026-02-22 09:10:26.423595708 +0000 UTC	deployed	localstack-0.6.27                 	latest     
loki         	monitoring   	1       	2026-02-22 09:11:25.949577345 +0000 UTC	deployed	loki-6.44.0                       	3.5.7      
pg-exporter  	listmonk     	1       	2026-02-22 09:11:24.300354069 +0000 UTC	deployed	prometheus-postgres-exporter-7.5.0	v0.19.0    
promtail     	monitoring   	1       	2026-02-22 09:11:26.07765436 +0000 UTC 	deployed	promtail-6.15.0                   	2.8.3      

[0;34mPods:[0m
NAMESPACE       NAME                                                        READY   STATUS    RESTARTS       AGE
argo-rollouts   argo-rollouts-7997fbf799-crxn4                              1/1     Running   0              35m
argocd          argocd-application-controller-0                             1/1     Running   0              40m
argocd          argocd-applicationset-controller-d45c59c4b-ps8h9            1/1     Running   0              40m
argocd          argocd-dex-server-c65bc8874-wnvgk                           1/1     Running   0              40m
argocd          argocd-notifications-controller-7dcc8d5948-5hmnn            1/1     Running   0              40m
argocd          argocd-redis-767f696dd7-vn9q8                               1/1     Running   0              40m
argocd          argocd-repo-server-84f9cf8768-h4jf5                         1/1     Running   0              40m
argocd          argocd-server-77fccc8b4b-tm22s                              1/1     Running   0              40m
cert-manager    cert-manager-cainjector-5469cf6649-t68v9                    1/1     Running   44 (61m ago)   97d
cert-manager    cert-manager-dc97f5746-vmmjn                                1/1     Running   39 (61m ago)   97d
cert-manager    cert-manager-webhook-54d9668fdc-8ndm8                       1/1     Running   44 (61m ago)   97d
ingress-nginx   ingress-nginx-controller-7dfff6b6ff-d9sbw                   1/1     Running   43 (61m ago)   97d
kube-system     coredns-64fd4b4794-w9fg6                                    1/1     Running   43 (61m ago)   97d
kube-system     local-path-provisioner-774c6665dc-z6668                     1/1     Running   38 (61m ago)   97d
kube-system     metrics-server-7bfffcd44-46srk                              1/1     Running   42 (61m ago)   97d
kube-system     sealed-secrets-controller-7c66f775fd-jw22c                  1/1     Running   14 (61m ago)   25d
kube-system     svclb-ingress-nginx-controller-80f2dc59-cxftk               2/2     Running   76 (61m ago)   97d
listmonk        listmonk-7bfcbd89f-q6kp7                                    1/1     Running   2 (34m ago)    34m
listmonk        pg-exporter-prometheus-postgres-exporter-6b5954bb95-9hsqz   1/1     Running   0              41m
listmonk        postgres-5bf96dc79c-7h8kh                                   1/1     Running   0              34m
localstack      localstack-79fbcc55b9-59xl7                                 1/1     Running   0              42m
mail            mailpit-5bbc55959-h79xj                                     1/1     Running   0              34m
monitoring      alertmanager-kps-kube-prometheus-stack-alertmanager-0       2/2     Running   0              41m
monitoring      kps-grafana-54796f6c89-zc2gk                                3/3     Running   0              41m
monitoring      kps-kube-prometheus-stack-operator-f9bfffdf9-2xksn          1/1     Running   0              41m
monitoring      kps-kube-state-metrics-757fb58579-8fz8t                     1/1     Running   0              41m
monitoring      loki-0                                                      2/2     Running   0              41m
monitoring      prometheus-kps-kube-prometheus-stack-prometheus-0           2/2     Running   0              41m
monitoring      promtail-lgvvp                                              1/1     Running   0              41m
monitoring      webhook-receiver-9878877c7-wh69q                            1/1     Running   0              34m

[0;34mBuckets Localstack:[0m
2026-02-22 09:18:47 listmonk-postgres-backup
2026-02-22 09:10:49 terraform-state

[0;34mCron Jobs:[0m
NAMESPACE   NAME              SCHEDULE      TIMEZONE   SUSPEND   ACTIVE   LAST SCHEDULE   AGE
listmonk    postgres-backup   0 */6 * * *   <none>     False     0        <none>          34m

[0;34mRollouts listmonk::[0m
NAME       DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
listmonk   1         1         1            1           34m
[0;32m[OK][0m Bootstrap completado
[0;32m[OK][0m Log completo: /home/eric/Proyecto/listmonk_Kubernetes/logs/bootstrap_20260222_095248.log
